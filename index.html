<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>REYDEASES</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="./styles.css" />

    <!-- Performance: adelanta conexi칩n con el Pixel -->
    <link rel="preconnect" href="https://connect.facebook.net" crossorigin />
    <link rel="dns-prefetch" href="//connect.facebook.net" />
    <link rel="preload" as="image" href="imagenes/fondo.png" />

    <!-- Meta Pixel Code (con coincidencias avanzadas manuales) -->
    <script>
      // Utilidades
      function getQS(name){ const u=new URLSearchParams(location.search); return u.get(name)||null }
      function normEmail(v){ return (v||"").trim().toLowerCase() }
      function normPhone(v){
        let p=(v||"").replace(/\D+/g,"");
        if(p && p.length===10) p="54"+p; // opcional, ajust치 a tu necesidad
        return p;
      }
      function getOrCreateExternalId(){
        const k="external_id";
        let id=localStorage.getItem(k);
        if(!id){
          id=(crypto && crypto.randomUUID) ? crypto.randomUUID() : (Date.now()+"-"+Math.random().toString(16).slice(2));
          localStorage.setItem(k,id);
        }
        return id;
      }

      // Datos de usuario disponibles (querystring o localStorage)
      const userEmail  = normEmail( getQS("em") || localStorage.getItem("em") || "" );
      const userPhone  = normPhone( getQS("ph") || localStorage.getItem("ph") || "" );
      const externalId = getOrCreateExternalId();

      !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
      n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');

      // Coincidencias avanzadas
      fbq('init', 'TU_PIXEL_ID', {
        external_id: externalId,
        em: userEmail || undefined,
        ph: userPhone || undefined,
        country: 'AR'
      });

      fbq('track', 'PageView');
    </script>
    <noscript>
      <img height="1" width="1" style="display:none"
           src="https://www.facebook.com/tr?id=TU_PIXEL_ID&ev=PageView&noscript=1"/>
    </noscript>
    <!-- End Meta Pixel Code -->
  </head>

  <body>
    <div class="container background-image">
      <div class="overlay"></div>
      <div class="content">
        <!-- Logo PNG -->
        <img src="imagenes/logo.png" class="logo" width="240" height="120"
             alt="CloverBlack" decoding="async" fetchpriority="high" />

        <p class="title">Envianos un WhatsApp<br />para crear tu cuenta</p>

        <a class="whatsapp-button" id="whatsappButton">
          <span>춰Contact치 ya!</span>
          <img src="imagenes/whatsapp.png" alt="whatsapp"
               class="whatsapp-icon" width="24" height="24" decoding="async" loading="lazy" />
        </a>

        <p class="subtitle">M칤nimo de carga 2.000<br />S칤n Cronogramas<br />Gan치s y cobr치s a cualquier hora</p>
        <p class="description">RED OFICIAL: REY DE ASES</p>
      </div>
    </div>

    <!-- Script WhatsApp con utm_campaign -> "Prefijo-UTM" -->
    <script>
      // === Configur치 tu prefijo ac치 ===
      const LANDING_PREFIX = ""; // Cambi치 si quer칠s otro prefijo

      // Lee un par치metro de la URL (?utm_campaign=...)
      function getQueryParam(name) {
        const params = new URLSearchParams(window.location.search);
        const v = params.get(name);
        return v ? decodeURIComponent(v) : null;
      }

      // Normaliza la UTM para el c칩digo (sin espacios/s칤mbolos raros)
      function normalizeUtm(v) {
        return String(v || "")
          .trim()
          .replace(/\s+/g, "_")
          .replace(/[^A-Za-z0-9_-]/g, "")
          || "ORG";
      }

      // Persistimos utm_campaign si viene en la URL
      (function persistUTM() {
        const utmFromUrl = getQueryParam("utm_campaign");
        if (utmFromUrl) {
          localStorage.setItem("utm_campaign", utmFromUrl);
        }
      })();

      // Obtiene utm_campaign (URL > localStorage > "ORG")
      function getUTMCampaign() {
        return getQueryParam("utm_campaign") || localStorage.getItem("utm_campaign") || "ORG";
      }

      document.getElementById("whatsappButton").addEventListener("click", function () {
        const numeros = [
          "549351", // 
          "549351"  // 
        ];
        
        const telefono = numeros[Math.floor(Math.random() * numeros.length)];

        const utm = normalizeUtm(getUTMCampaign());
        const codigo = `${LANDING_PREFIX}-${utm}`;

        const variantes = [
          `춰Hola! Vi este anuncio, 쯠e pas치s info?`,
          `Hola! Vi el anuncio, 쯣od칠s darme m치s info?`,
          `Buenas! 쯄e cont치s un poco m치s del anuncio?`,
          `Hola! Quisiera saber m치s sobre lo que ofrecen.`,
          `Buenas! 쯄e das m치s detalles, por favor?`,
          `Hola! Estoy interesado/a, 쯖칩mo funciona todo?`,
          `Hola! Vi tu publicaci칩n, 쯣odr칤as ampliarme la info?`,
          `Buenas! 쯄e podr칤as pasar informaci칩n?`,
          `Hola! Estoy viendo el anuncio, 쯠e das m치s datos?`,
          `Buenas! Me interesa, 쯣odr칤as contarme m치s?`,
          `Hola! 쮺칩mo hago para empezar?`,
          `Buenas! 쯄e compart칤s info para sumarme?`,
          `Hola! 쯊en칠s m치s detalles del anuncio?`,
          `Buenas! Quiero m치s info, gracias.`,
          `Hola! Me interesa, 쯠e explic치s un poco?`,
          `Buenas! 쯈u칠 pasos tengo que seguir?`,
          `Hola! Vi el aviso, 쯠e das info?`,
          `Buenas! Estoy interesado/a, 쯠e pas치s detalles?`,
          `Hola! 쯄e cont치s de qu칠 se trata?`,
          `Buenas! Quiero saber m치s, 쯠e ayud치s?`,
          `Hola! 쯇odr칤as darme un poco m치s de informaci칩n?`,
          `Buenas! Estoy viendo el anuncio, 쯠e explic치s?`,
          `Hola! Estoy interesado/a, 쯖칩mo es el proceso?`,
          `Buenas! Me gustar칤a saber m치s antes de avanzar.`,
          `Hola! Vi esto, 쯠e pas치s m치s data?`,
          `Buenas! 쯄e podr칤as orientar un poco?`,
          `Hola! Quiero saber m치s, 쯠e cont치s?`,
          `Buenas! Estoy averiguando, 쯦en칠s m치s info?`,
          `Hola! 쮺칩mo hago para continuar?`,
          `Buenas! Estoy interesado/a, 쯖칩mo funciona?`,
          `Hola! Vi tu anuncio, 쯠e das m치s informaci칩n?`,
          `Buenas! Estoy viendo esto, 쯠e ayud치s con m치s detalles?`,
          `Hola! Me interesa, 쯖칩mo sigo?`,
          `Buenas! 쯄e explicar칤as c칩mo es todo?`,
          `Hola! 쯇odr칤as ampliarme los detalles?`,
          `Buenas! Quisiera saber un poco m치s.`,
          `Hola! 쮺칩mo puedo empezar?`,
          `Buenas! Me llam칩 la atenci칩n, 쯠e cont치s m치s?`,
          `Hola! 쯄e pas치s info para avanzar?`,
          `Buenas! 쯊en칠s m치s detalles para compartir?`,
          `Hola! Estoy interesado/a, 쯖칩mo ser칤a todo?`,
          `Buenas! Vi tu publicaci칩n, 쯠e das m치s datos?`,
          `Hola! Quiero saber c칩mo funciona, 쯠e explic치s?`,
          `Buenas! Vi esto, 쯖칩mo puedo seguir?`,
          `Hola! 쯄e indicar칤as c칩mo funciona todo esto?`,
          `Buenas! 쯄e das info para continuar?`,
          `Hola! Me interesa mucho, 쯠e cont치s un poco?`,
          `Buenas! Necesito un poco m치s de info, 쯣od칠s ayudarme?`,
          `Hola! 쯈u칠 tengo que hacer para empezar?`
        ];

        const mensajeBase = variantes[Math.floor(Math.random() * variantes.length)];
        const mensaje = mensajeBase;
        const link = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje)}`;

        // 游댯 Evento est치ndar "Contact" por c칩digo
        if (window.fbq) {
          fbq('track', 'Contact', {
            content_name: 'CTA WhatsApp',
            content_category: 'LeadGen'
          });
        }

        // Peque침o delay para asegurar env칤o antes de abrir WhatsApp
        setTimeout(() => window.open(link, "_blank", "noopener"), 200);
      });
    </script>
  </body>
</html>
